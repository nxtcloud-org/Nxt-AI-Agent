# 🧠 메모리 기능 포함 멀티 에이전트 학사 상담 시스템

React 클라이언트와 CrewAI 기반 멀티 에이전트 시스템을 연결한 웹 애플리케이션입니다.
**대화 기록을 기억하고 맥락을 인식하는 지능형 상담 시스템**입니다.

## 🏗️ 시스템 구조

```
8.memory_agent/
├── client/                 # React 프론트엔드
│   ├── public/
│   ├── src/
│   │   ├── components/
│   │   │   ├── LoginForm.js      # 학생 인증 폼
│   │   │   └── ChatInterface.js  # 채팅 인터페이스
│   │   ├── App.js
│   │   └── index.js
│   └── package.json
├── server/                 # FastAPI 백엔드
│   ├── tools/             # CrewAI 도구들
│   ├── app.py            # FastAPI 서버
│   ├── agent_system.py   # CrewAI 멀티 에이전트 시스템
│   ├── pyproject.toml    # uv 프로젝트 설정
│   └── requirements.txt  # pip 호환성용
└── README.md
```

## 🔄 동작 흐름

1. **학생 인증**: 클라이언트에서 학번 입력 → DB 조회로 학생 확인
2. **채팅 시작**: 인증된 학생만 AI 에이전트와 대화 가능
3. **질문 처리**: React → FastAPI → CrewAI 멀티 에이전트 (비동기) → 응답 반환

## 🚀 실행 방법

### 1. 서버 실행 (터미널 1)

```bash
cd 8.memory_agent/server
uv run app.py
```

### 2. 클라이언트 실행 (터미널 2)

```bash
cd 8.memory_agent/client
npm install  # 처음 실행 시에만
npm start
```

### 3. 접속

- **클라이언트**: http://localhost:3000
- **API 서버**: http://localhost:8000
- **API 문서**: http://localhost:8000/docs

## 📋 주요 기능

### 클라이언트 (React)

- 🔐 학번 기반 학생 인증
- 💬 실시간 채팅 인터페이스
- 💡 추천 질문 제공
- 📱 반응형 디자인

### 서버 (FastAPI + CrewAI)

- 🔍 학생 인증 API (`/api/auth/verify`)
- 💬 채팅 API (`/api/chat`) - 비동기 처리
- 🧠 메모리 상태 API (`/api/memory/{student_id}`)
- 🤖 멀티 에이전트 시스템 연동
- 🛡️ 보안 검증
- 📚 자동 API 문서 (`/docs`)

### AI 에이전트 시스템 (메모리 기능 포함)

- 👨‍🎓 **학생 정보 전문가**: 기본 정보 및 수강 이력 조회 + 이전 대화 맥락 인식
- 🎓 **졸업 요건 전문가**: 졸업 요건 및 학점 정보
- 📚 **강의 정보 전문가**: 강의 검색 및 정보 제공
- 💡 **수강 추천 전문가**: 개인화된 수강 추천 + 이전 상담 내용 반영
- 📝 **요약 전문가**: 정보 종합 및 요약 + 대화 연속성 유지
- 🧠 **메모리 시스템**: 대화 기록 저장, 맥락 인식, 개인화된 상담

## 🔧 환경 설정

### 서버 환경 변수 (.env)

```env
BEDROCK_MODEL_ID=your_model_id
AWS_ACCESS_KEY_ID=your_access_key
AWS_SECRET_ACCESS_KEY=your_secret_key
AWS_DEFAULT_REGION=your_region
```

### 데이터베이스

- SQLite 데이터베이스 (`../0.data/university.db`) 필요
- 학생 정보 테이블 (`students`) 필요

## 🛠️ 기술 스택

### 프론트엔드

- React 18
- CSS3 (모던 스타일링)
- Fetch API

### 백엔드

- FastAPI (현대적 Python 웹 프레임워크)
- Uvicorn (ASGI 서버)
- Pydantic (데이터 검증)
- SQLite (데이터베이스)
- uv (Python 패키지 관리)

### AI 시스템

- CrewAI (멀티 에이전트 프레임워크)
- AWS Bedrock (LLM)
- LangChain (AI 도구 체인)

## 📝 사용 예시 (메모리 기능 포함)

### 첫 번째 대화

1. **학번 입력**: `20230578`
2. **인증 완료**: "안녕하세요 김철수님!"
3. **질문 입력**: "내 졸업 요건 알려줘"
4. **AI 응답**: 멀티 에이전트가 협력하여 상세한 답변 제공
5. **메모리 저장**: 대화 내용이 `memory_20230578.json`에 저장

### 두 번째 대화 (연속성)

1. **질문 입력**: "그럼 다음 학기에 뭘 들으면 좋을까?"
2. **AI 응답**: 이전 졸업 요건 상담 내용을 기억하고 연관된 추천 제공
3. **맥락 인식**: "앞서 말씀드린 졸업 요건을 고려하면..."

### 세 번째 대화 (개인화)

1. **질문 입력**: "저번에 추천해준 과목들 중에서..."
2. **AI 응답**: 이전 추천 내용을 정확히 기억하고 후속 조언 제공

## 🔒 보안 기능

- 학번 기반 사용자 인증
- API 요청 시 재인증 검증
- 개인정보 보호 준수
- CORS 정책 적용

## 🎯 주요 특징

- **실시간 채팅**: 자연스러운 대화형 인터페이스
- **멀티 에이전트**: 전문 분야별 에이전트 협력
- **개인화**: 인증된 학생 정보 기반 맞춤 서비스
- **🧠 메모리 기능**: 대화 기록 저장 및 맥락 인식
- **연속성**: 이전 대화를 기억하는 지능형 상담
- **개인화된 추천**: 과거 상담 내용을 반영한 맞춤 추천
- **확장성**: 새로운 에이전트 및 기능 추가 용이

## 🧠 메모리 시스템 특징

### 대화 기록 관리

- 학생별 개별 메모리 파일 (`memory_{student_id}.json`)
- 최대 10개의 최근 대화 기록 유지
- 질문, 답변, 질문 유형, 시간 정보 저장

### 맥락 인식 기능

- 이전 대화 내용을 바탕으로 한 연속성 있는 답변
- 학생 정보 전문가와 수강 추천 전문가에서 이전 대화 맥락 활용
- 요약 전문가에서 전체 대화 흐름 고려

### 세션 관리

- 학생별 AgentSystem 인스턴스 캐시
- 서버 재시작 전까지 메모리 유지
- 파일 기반 영구 저장으로 데이터 보존

### API 엔드포인트

- `/api/memory/{student_id}`: 학생의 메모리 상태 확인
- 대화 기록 수, 최근 주제 요약 제공

## 🚨 주의사항

- 서버와 클라이언트를 모두 실행해야 정상 작동
- 데이터베이스 파일 경로 확인 필요
- AWS Bedrock 설정 및 권한 필요
- Node.js 및 Python 환경 필요
